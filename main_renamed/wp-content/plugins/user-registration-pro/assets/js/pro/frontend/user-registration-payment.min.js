jQuery(function(t){var n=user_registration_params.ursL10n;t(".ur-frontend-form").each(function(){var o=t(this),e={init:function(){t(document).ready(e.ready),e.bindUIActions()},ready:function(){e.loadTotal()},loadTotal:function(){t(".ur-frontend-form").find(".ur-total-amount").each(function(){e.calculateTotalAmount(this)})},bindUIActions:function(){var a=o.find(".field-single_item:not([style*='display: none'])");t(document).on("change input",a,function(){e.calculateTotalAmount(this,!0)}),t(document).on("input keypress",".ur-payment-price",function(n){var o=t(this),e=o.val();o.val(e.toString().replace(/[^0-9.]/g,""))}),t(document).on("input keypress change","input.ur-quantity",function(){t(this).val()||t(this).val(0)}),t(document).on("click",".ur-apply-coupon-btn",function(){var o=t(this),a=t(".ur_coupon_field").val(),i=o.text(),r=t(".ur-frontend-form").find("form").data("form-id"),u=t("#coupon-error"),c={action:"user_registration_pro_get_coupon_detail",security:user_registration_pro_frontend_data.user_data_nonce,coupon:a,form_id:r};if(total_amount=t("input[id^=total_field_]").val(),total_amount<=0)return u.hide(),void u.text(n.i18n_total_field_value_zero).css({display:"block"});t.ajax({url:user_registration_pro_frontend_data.ajax_url,type:"POST",data:c,beforeSend:function(){o.text(user_registration_pro_frontend_data.applying_coupon_text)},success:function(n){n.success?(u.hide(),o.text(i),o.hide(),e.calculate_coupon_details(n)):(t(".user-registration-error").hide(),u.hide(),u.text(n.data).css({display:"block"}))},error:function(t){console.log(t)},complete:function(){o.text(i)}})}),t(document).on("click",".clear-coupon",function(){var n=t(".ur_coupon_field");t(".coupon-message").text(""),t("#coupon-error").hide(),n.val(""),n.removeAttr("data-coupon-discount").removeData("coupon-discount"),n.removeAttr("data-coupon-discount-type").removeData("coupon-discount-type"),n.removeAttr("data-coupon-discount-target-field").removeData("coupon-discount-target-field"),t(".ur-apply-coupon-btn").show(),e.calculateTotalAmount()})},calculate_coupon_total:function(t,n,o){return"percent"===t?n-n*(o/100):n-o},calculateTotalAmount:function(){var n=0,a="",i="",r="",u=o.find('.field-coupon:not([style*="display: none"])').find("input");t.map(u,function(n){a=t(n).data("coupon-discount-type"),i=t(n).data("coupon-discount");var o=t(n).data("coupon-discount-target-field"),e=new RegExp("single_item");o&&(r=o.match(e)?"single_item":"total_field")});var c=o.find(".field-single_item:not([style*='display: none'])");t.map(c,function(o){var u=""!==t(o).find("input").val()?t(o).find("input").val():0,c=t(o).find("input").attr("data-id");"single_item"===r&&(u=e.calculate_coupon_total(a,u,i)),n=parseFloat(n)+parseFloat(u)*e.getQuantity(c)});if(o.find(".field-range:not([style*='display: none'])").find(".ur-currency-sign").length>0){$rangeSlider=o.find(".field-range:not([style*='display: none'])").find(".ur-currency-sign").parent().parent();t.map($rangeSlider,function(o){var a=""!==t(o).find("input[type='number']").val()?t(o).find("input[type='number']").val():0,i=t(o).find("input[type='number']").attr("name");n=parseFloat(n)+parseFloat(a)*e.getQuantity(i)})}var d=o.find(".field-multiple_choice:not([style*='display: none'])").find("input"),l=(t.map(d,function(o){if("checkbox"===t(o).attr("type"))var a=t(o).prop("checked")?t(o).val():0;var i=t(o).attr("data-id");n=parseFloat(n)+parseFloat(a)*e.getQuantity(i)}),o.find(".field-subscription_plan:not([style*='display: none'])").find("input"));t.map(l,function(o){if("radio"===t(o).attr("type"))var a=t(o).prop("checked")?t(o).val():0;var i=t(o).attr("data-id");n=parseFloat(n)+parseFloat(a)*e.getQuantity(i)});return i!=undefined&&(n=n?this.calculate_coupon_total(a,n,i)<=0?0:this.calculate_coupon_total(a,n,i):0),o.find(".ur-total-amount").each(function(){"hidden"===t(this).attr("type")||"text"===t(this).attr("type")?t(this).val(n):t(this).text(n)}),n},getQuantity:function(n){var o=1,e=t("input[data-target="+n);return 0!=e.length&&(o=e.first().val()),parseInt(o)},calculate_coupon_details:function(o){var a=JSON.parse(o.data.coupon_details),i=t(".ur_coupon_field"),r=t("#coupon-error");i.attr("data-coupon-discount",a.coupon_discount),i.attr("data-coupon-discount-type",a.coupon_discount_type),i.attr("data-coupon-discount-target-field",a.target_field);var u=e.calculateTotalAmount();if("fixed"===a.coupon_discount_type&&u<=0)return i.attr("data-coupon-discount",0),i.attr("data-coupon-discount-type","fixed"),i.attr("data-coupon-discount-target-field",a.target_field),e.calculateTotalAmount(),t(".user-registration-error").hide(),r.hide(),r.text(n.i18n_discount_total_zero).css({display:"block"}),void t(".ur-apply-coupon-btn").show();r.hide();var c=new RegExp("single_item"),d=("fixed"===a.coupon_discount_type?user_registration_pro_frontend_data.currency_symbol:"")+a.coupon_discount+("percent"===a.coupon_discount_type?"%":""),l=a.target_field.match(c)?user_registration_pro_frontend_data.single_item_discount:user_registration_pro_frontend_data.total_item_discount;t("#coupon-success").text(l+d)}};e.init(jQuery)}),t(document).ready(function(){t(document).on("user_registration_frontend_multiple_choice_data_filter",function(n,o,e){var a=[];e.each(function(){if(t(this).is(":checked")){var n=t(this).siblings("label").text(),o=t(this).val();a.push(n+":"+o)}}),o=a,e.closest(".field-multiple_choice").data("payment-value",o)})})});